(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[493],{24433:function(xe,b,e){"use strict";e.d(b,{Z:function(){return E}});var ge=e(9715),w=e(86585),pe=e(57663),q=e(71577),ee=e(11849),te=e(43185),ue=e(94412),ne=e(34792),ce=e(48086),I=e(3182),me=e(94043),v=e.n(me),De=e(67294),p=e(43347),Z=e(18547),c=e(92136),a=e(85893),E=function(U){var x=U.setOpenMail64,T=U.openMail64,ve=[],ae={fileList:ve,beforeUpload:function(){var M=(0,I.Z)(v().mark(function f(D){var j;return v().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(D.type==="application/pdf"){h.next=4;break}ce.default.error("".concat(D.name," ist keine PDF")),h.next=9;break;case 4:return h.next=6,fe(D);case 6:j=h.sent,D.base64=j,x(j);case 9:case"end":return h.stop()}},f)}));function B(f){return M.apply(this,arguments)}return B}()},fe=function(B){var f=new FileReader;return new Promise(function(D,j){f.onload=function(W){D(W.target.result)},f.readAsDataURL(B)})};return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(w.Z.Item,{name:"fileupload",rules:[{required:!0,message:"PDF fehlt"}],children:T===null?(0,a.jsx)(ue.Z.Dragger,(0,ee.Z)((0,ee.Z)({},ae),{},{children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(p.Z,{})}),(0,a.jsx)("p",{className:"ant-upload-text",children:"anklicken / PDF reinziehen"})]})})):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(q.Z,{style:{float:"right"},icon:(0,a.jsx)(Z.Z,{}),type:"ghost",onClick:function(){return x(null)},children:"entfernen "}),(0,a.jsx)("br",{})," ",(0,a.jsx)("br",{}),(0,a.jsx)(c.Z,{file:T,loading:!1,type:"base64"})]})})})}},29468:function(xe,b,e){"use strict";e.r(b),e.d(b,{default:function(){return Te}});var ge=e(20228),w=e(11382),pe=e(22385),q=e(69713),ee=e(57663),te=e(71577),ue=e(47673),ne=e(4107),ce=e(71194),I=e(5644),me=e(71153),v=e(60331),De=e(34792),p=e(48086),Z=e(3182),c=e(2824),a=e(94043),E=e.n(a),m=e(67294),U=e(18547),x=e(43581),T=e(32059),ve=e(13062),ae=e(71230),fe=e(89032),M=e(15746),B=e(9715),f=e(86585),D=e(402),j=e(59289),W=e(11238),h=e(24433),he=e(25753),L=e(17753),t=e(85893),je=j.Z.Text,se=j.Z.Title,ye=function(A){var O,F,R,_,g,y,n=A.visible,K=A.close,N=A.reloadTable,C=n==null||(O=n.mail)===null||O===void 0?void 0:O.task,S=n==null||(F=n.mail)===null||F===void 0?void 0:F.mails_id,k=n==null||(R=n.mail)===null||R===void 0?void 0:R.id_company,Q=n==null||(_=n.mail)===null||_===void 0?void 0:_.state,le=n==null||(g=n.mail)===null||g===void 0?void 0:g.companyname,re=(0,m.useState)(!1),$=(0,c.Z)(re,2),z=$[0],P=$[1],ie=(0,m.useState)(null),G=(0,c.Z)(ie,2),J=G[0],Y=G[1],V=f.Z.useForm(),oe=(0,c.Z)(V,1),H=oe[0];(0,m.useEffect)(function(){Y(null),H.resetFields()},[n]);var d=function(){var s=(0,Z.Z)(E().mark(function u(o){var l,i;return E().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return l="",i={},C==="SCANNED_REQ"?(l=L.Q+"/api/admin/starttasksca",i={mails_id:S,id_company:k,subject:o.subject,file:J}):(l=L.Q+"/api/admin/starttaskfordes",i={mails_id:S,task:C,id_company:k,state:Q}),P(!0),X.next=6,(0,W.ZP)(l,{method:"POST",data:i}).then(function(de){de==="ok"?(p.default.success("Erledigt!"),K(),N()):p.default.error("Fehler")}).catch(function(de){(0,he.S)(de,!0,"Fehler","Die Aufgabe konnte nicht erledigt werden.")});case 6:P(!1);case 7:case"end":return X.stop()}},u)}));return function(o){return s.apply(this,arguments)}}(),r=function(u){return(0,t.jsx)(je,{style:{textAlign:"center",boxShadow:"1px 4px 6px 1px rgba(0, 0, 0, 0.2)"},children:(0,t.jsxs)("pre",{children:[(0,t.jsxs)(ae.Z,{children:[(0,t.jsx)(M.Z,{span:12,children:(0,t.jsxs)("p",{children:["BRIEF ",(0,t.jsx)(se,{children:S})]})}),(0,t.jsx)(M.Z,{span:12,children:(0,t.jsxs)("p",{children:["AUFGABE ",(0,t.jsx)(se,{children:u})]})})]}),(0,t.jsxs)("p",{children:["FIRMA ",(0,t.jsx)(se,{children:le})]})]})})};return(0,t.jsx)(I.Z,{visible:n.show,maskStyle:{backgroundColor:n.color},title:"",onCancel:K,destroyOnClose:!0,footer:null,width:"110vh",children:(0,t.jsxs)(f.Z,{layout:"vertical",form:H,hideRequiredMark:!0,onFinish:d,children:[(0,t.jsx)(te.Z,(y={htmlType:"submit",type:"primary"},(0,T.Z)(y,"htmlType","submit"),(0,T.Z)(y,"loading",z),(0,T.Z)(y,"children","Erledigt"),y)),C==="SCANNED_REQ"&&(0,t.jsxs)(t.Fragment,{children:[r("SCANNEN"),(0,t.jsx)(f.Z.Item,{label:"Betreff",name:"subject",children:(0,t.jsx)(ne.Z,{size:"large"})}),(0,t.jsx)(h.Z,{setOpenMail64:Y,openMail64:J})]}),C==="FORWARDED_REQ"&&r("WEITERLEITEN"),C==="DESTROYED_REQ"&&r("VERNICHTEN")," "]})})},Ce=e(8060),Te=function(){var A=(0,x.md)(),O=(0,m.useRef)(),F=(0,m.useState)({show:!1,mail:{mails_id:null,task:{task:null}}}),R=(0,c.Z)(F,2),_=R[0],g=R[1],y=function(){g({show:!1,mail:null})},n=function(){O.current.reload()},K=(0,m.useState)(!1),N=(0,c.Z)(K,2),C=N[0],S=N[1],k=(0,m.useState)({user_id:{fixed:"left",show:!1},recieve_email:{fixed:"left",show:!1},open_recieved_mail:{fixed:"left",show:!1},send_notifications:{fixed:"left",show:!1}}),Q=(0,c.Z)(k,2),le=Q[0],re=Q[1],$=(0,m.useState)(""),z=(0,c.Z)($,2),P=z[0],ie=z[1],G=function(){var d=(0,Z.Z)(E().mark(function r(s,u){return E().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(P.length<5)){l.next=3;break}return p.default.warning("Begr\xFCndung ist zu kurz."),l.abrupt("return");case 3:return S(!0),l.next=6,(0,x.WY)(L.Q+"/api/admin/deletetask",{method:"POST",data:{mails_id:s,id_company:u,reasonText:P}}).then(function(i){i==="ok"?(p.default.success("Gel\xF6scht!"),n()):p.default.error("Fehler")}).catch(function(i){(0,he.S)(i,!0,"Fehler","Die Aufgabe konnte nicht gel\xF6scht werden.")});case 6:S(!1);case 7:case"end":return l.stop()}},r)}));return function(s,u){return d.apply(this,arguments)}}(),J=[{title:"Aufgabe",dataIndex:"task",key:"task",valueEnum:{SCANNED_REQ:{text:(0,t.jsx)(v.Z,{color:"#eb2f96",children:"\xF6ffnen & scannen"})},FORWARDED_REQ:{text:(0,t.jsx)(v.Z,{color:"#0050b3",children:"weiterleiten"})},DESTROYED_REQ:{text:(0,t.jsx)(v.Z,{color:"#d48806",children:"vernichten"})}},render:function(r,s,u,o){return[(0,t.jsxs)(t.Fragment,{children:[s.task==="SCANNED_REQ"?(0,t.jsx)(v.Z,{onClick:function(){return g({show:!0,mail:s,color:"#eb2f96"})},color:"#eb2f96",children:(0,t.jsx)("a",{children:"\xF6ffnen & scannen"})}):null,s.task==="FORWARDED_REQ"?(0,t.jsx)(v.Z,{onClick:function(){return g({show:!0,mail:s,color:"#0050b3"})},color:"#0050b3",children:(0,t.jsx)("a",{children:"weiterleiten"})}):null,s.task==="DESTROYED_REQ"?(0,t.jsx)(v.Z,{onClick:function(){return g({show:!0,mail:s,color:"#d48806"})},color:"#d48806",children:(0,t.jsx)("a",{children:"vernichten"})}):null]})]}},{title:"Eingegangen am",dataIndex:"to_char",key:"to_char"},{title:"Brief ID",dataIndex:"mails_id",key:"mails_id"},{title:"Firma ID",dataIndex:"id_company",key:"id_company"},{title:"Firma",dataIndex:"companyname",key:"companyname"},{title:"Aktion",key:"delete",align:"center",render:function(r,s,u,o){return[(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(q.Z,{placement:"left",title:"Aufgabe vernichten",children:(0,t.jsx)(te.Z,{type:"link",icon:(0,t.jsx)(U.Z,{}),onClick:function(){return I.Z.confirm({title:"Grund f\xFCr L\xF6schen der Aufgabe",content:(0,t.jsx)(ne.Z.TextArea,{onChange:function(Ee){return ie(Ee.target.value)}}),okText:"Best\xE4tigen",cancelText:"Abbrechen",onOk:function(){return G(s.mails_id,s.id_company,P)}})}})})})]}}],Y=(0,m.useState)(""),V=(0,c.Z)(Y,2),oe=V[0],H=V[1];return(0,t.jsxs)(x.Nv,{accessible:A.canAdmin,fallback:function(){return x.m8.push("/exception/403")},children:[(0,t.jsx)(w.Z,{spinning:C,children:(0,t.jsx)(Ce.ZP,{actionRef:O,onColumnsStateChange:function(r){return re(r)},columns:J,request:(0,Z.Z)(E().mark(function d(){var r,s,u,o=arguments;return E().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=o.length>0&&o[0]!==void 0?o[0]:{},s=o.length>1?o[1]:void 0,u=o.length>2?o[2]:void 0,i.abrupt("return",(0,x.WY)(L.Q+"/api/admin/loadtasks?search=".concat(oe),{params:r}));case 4:case"end":return i.stop()}},d)})),rowKey:"mails_id",columnsStateMap:le,pagination:{showQuickJumper:!1,showSizeChanger:!0},dateFormatter:"string",headerTitle:"Aufgaben",toolbar:{search:{onSearch:function(r){H(r),n()},placeholder:"Firmenname"}},search:!1})}),(0,t.jsx)(ye,{visible:_,close:y,reloadTable:n})]})}}}]);
