(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[463],{16027:function(ge){ge.exports={card:"card___1QvqX",content:"content___Y9RHm"}},24433:function(ge,ue,t){"use strict";t.d(ue,{Z:function(){return Ae}});var Ie=t(9715),ce=t(86585),Le=t(57663),P=t(71577),je=t(11849),m=t(43185),s=t(94412),a=t(34792),se=t(48086),Se=t(3182),he=t(94043),Me=t.n(he),k=t(67294),Ee=t(43347),Ze=t(18547),Te=t(92136),i=t(85893),Ae=function(ye){var z=ye.setOpenMail64,_=ye.openMail64,Re=[],Ce={fileList:Re,beforeUpload:function(){var D=(0,Se.Z)(Me().mark(function q(Y){var $;return Me().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Y.type==="application/pdf"){e.next=4;break}se.default.error("".concat(Y.name," ist keine PDF")),e.next=9;break;case 4:return e.next=6,Fe(Y);case 6:$=e.sent,Y.base64=$,z($);case 9:case"end":return e.stop()}},q)}));function N(q){return D.apply(this,arguments)}return N}()},Fe=function(N){var q=new FileReader;return new Promise(function(Y,$){q.onload=function(ne){Y(ne.target.result)},q.readAsDataURL(N)})};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(ce.Z.Item,{name:"fileupload",rules:[{required:!0,message:"PDF fehlt"}],children:_===null?(0,i.jsx)(s.Z.Dragger,(0,je.Z)((0,je.Z)({},Ce),{},{children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{className:"ant-upload-drag-icon",children:(0,i.jsx)(Ee.Z,{})}),(0,i.jsx)("p",{className:"ant-upload-text",children:"anklicken / PDF reinziehen"})]})})):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(P.Z,{style:{float:"right"},icon:(0,i.jsx)(Ze.Z,{}),type:"ghost",onClick:function(){return z(null)},children:"entfernen "}),(0,i.jsx)("br",{})," ",(0,i.jsx)("br",{}),(0,i.jsx)(Te.Z,{file:_,loading:!1,type:"base64"})]})})})}},72961:function(ge,ue,t){"use strict";t.r(ue),t.d(ue,{default:function(){return ke}});var Ie=t(35556),ce=t(97880),Le=t(57663),P=t(71577),je=t(58024),m=t(39144),s=t(2824),a=t(67294),se=t(43581),Se=t(16027),he=t.n(Se),Me=t(18106),k=t(41046),Ee=t(71194),Ze=t(5644),Te=t(402),i=t(59289),Ae=t(49111),le=t(19650),ye=t(88983),z=t(47933),_=t(3182),Re=t(74379),Ce=t(38648),Fe=t(94043),D=t.n(Fe),N=t(11238),q=t(64970),Y=t.n(q),$=t(17753),ne=t(25753),e=t(85893),Ke=function(n){var d=n.company,j=n.compSel,c=n.next,S=n.SelText,M=n.loadFileFrontMail,Z=n.setManualOrAuto,E=(0,a.useState)(!1),B=(0,s.Z)(E,2),F=B[0],l=B[1],o=(0,a.useState)(null),R=(0,s.Z)(o,2),O=R[0],r=R[1],u=(0,a.useState)(!1),I=(0,s.Z)(u,2),v=I[0],Q=I[1],f=(0,a.useState)(!1),x=(0,s.Z)(f,2),g=x[0],ae=x[1],T={width:916,height:464,facingMode:"user"},U={width:916,height:1296,facingMode:"user"},V=function(){Ce.default.error({message:"Firma nicht erkannt"})},L=a.useRef(null),ee=a.useCallback(function(){var y,b=L==null||(y=L.current)===null||y===void 0?void 0:y.getScreenshot();ve(b),r(b)},[L,r]),ve=function(){var y=(0,_.Z)(D().mark(function b(J){var X;return D().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(J!=null){A.next=2;break}return A.abrupt("return");case 2:return l(!0),X={file:J,width:g?T.width:U.width,height:g?T.height:U.height,tesseract:!0},A.next=6,(0,N.ZP)($.Q+"/api/admin/ocrscanner",{method:"POST",data:X}).then(function(C){var w=C.company,oe=C.text,de=C.pdf;r(null),w==null?V():(Q(!0),Z("autom"),j(w),S(oe),M(de))}).catch(function(C){r(null),(0,ne.S)(C,!0,"Fehler","Die OCR Erkennung konnte nicht durchgef\xFChrt werden.")});case 6:l(!1);case 7:case"end":return A.stop()}},b)}));return function(J){return y.apply(this,arguments)}}(),H=function(){ae(!g)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(le.Z,{style:{width:"100%"},direction:"vertical",children:[(0,e.jsxs)(z.ZP.Group,{size:"large",onChange:H,buttonStyle:"solid",defaultValue:"a",children:[(0,e.jsx)(z.ZP.Button,{style:{width:"458px",height:"50px"},value:"a",children:"Document"}),(0,e.jsx)(z.ZP.Button,{style:{width:"458px",height:"50px"},value:"b",children:"Brief"})]}),(0,e.jsx)(P.Z,{style:{width:"100%",height:"100px",borderRadius:"25px"},type:"primary",loading:F,onClick:ee,children:"PHOTO"}),O?(0,e.jsx)("img",{src:O}):(0,e.jsx)(Y(),{audio:!1,height:g?T.height:U.height,ref:L,screenshotFormat:"image/jpeg",screenshotQuality:.5,width:g?T.width:U.width,videoConstraints:g?T:U})]}),(0,e.jsxs)(Ze.Z,{title:"Modal",visible:v,footer:null,onCancel:function(){return Q(!1)},children:["Firma ausgew\xE4hlt:",(0,e.jsxs)(i.Z.Title,{level:1,children:[" ",d==null?void 0:d.name]}),(0,e.jsxs)("p",{children:[(0,e.jsx)(P.Z,{onClick:function(){return c()},children:"Richtig"}),(0,e.jsx)(P.Z,{onClick:function(){return Q(!1)},children:"Falsch"})]})]})]})},me=t(11849),_e=t(60663),We=t(31990),ze=t(64317),Ye=t(74498),$e=function(n){var d=n.compSel,j=n.next,c=n.setManualOrAuto,S=(0,a.useState)([]),M=(0,s.Z)(S,2),Z=M[0],E=M[1],B=function(l){c("manual"),j();for(var o=0;o<Z.length;o++)Z[o].id_company===l&&d(Z[o])};return(0,e.jsx)(m.Z,{className:he().card,bordered:!1,children:(0,e.jsx)(ze.Z,{name:"id_company",fieldProps:{size:"large",optionItemRender:function(l){return(0,e.jsx)(We.Z,{avatar:(0,e.jsx)(Ye.Z,{}),author:l.username,content:l.name})},onChange:function(l,o){return B(l)},filterOption:!1},showSearch:!0,request:function(){var F=(0,_.Z)(D().mark(function l(o){var R,O,r,u;return D().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return R=o.keyWords,v.next=3,(0,N.ZP)($.Q+"/api/admin/getallcompanydata?current=".concat(1,"&pageSize=",20,"&search=",R),{method:"GET"});case 3:for(O=v.sent,r=O.data,u=0;u<r.length;u++)r[u]=(0,me.Z)((0,me.Z)({},r[u]),{},{value:r[u].id_company});return E(r),v.abrupt("return",r);case 8:case"end":return v.stop()}},l)}));return function(l){return F.apply(this,arguments)}}(),placeholder:"Suche ..."},"id_company")})},Ve=function(n){var d=n.company,j=n.compSel,c=n.next,S=n.loadFileFrontMail,M=n.selectedText,Z=n.setManualOrAuto;return(0,e.jsx)(m.Z,{children:(0,e.jsxs)(k.Z,{size:"large",defaultActiveKey:"1",centered:!0,children:[(0,e.jsx)(k.Z.TabPane,{tab:"Photo",children:(0,e.jsx)(Ke,{compSel:j,next:c,SelText:M,loadFileFrontMail:S,setManualOrAuto:Z,company:d})},"1"),(0,e.jsx)(k.Z.TabPane,{tab:"Suche",children:(0,e.jsx)($e,{compSel:j,next:c,setManualOrAuto:Z})},"2")]})})},qe=t(14965),Ge=t(35662),et=t(47673),Ue=t(4107),tt=t(34792),be=t(48086),nt=t(9715),re=t(86585),Ne=t(30381),Qe=t.n(Ne),Be=t(24433),Oe=t(92136),He=i.Z.Paragraph,Je={user:"Firma",openS:"Briefe \xF6ffnen?",notes:"Notizen",subject:"Betreff",sender:"Absender",cover:"Briefumschlag",open:"Briefdokument",recieved:"Empfangen am"},Xe=function(n){var d=n.selComp,j=n.selText,c=n.next,S=n.prev,M=n.setOpenMail64,Z=n.openMail64,E=n.setSenderr,B=n.setDatee,F=n.setSubjectt,l=n.frontMail,o=n.loadFileFrontMail,R=n.manualOrAuto,O=re.Z.useForm(),r=(0,s.Z)(O,1),u=r[0],I=function(){var h=new Date,K=String(h.getDate()).padStart(2,"0"),te=String(h.getMonth()+1).padStart(2,"0"),xe=h.getFullYear();return xe+"-"+te+"-"+K},v=function(h){l===null?be.default.error("Brief Vorderseite fehlt"):(E(h.sender),B(h.recieved.format("YYYY-MM-DD")),F(h.subject),c())},Q={form:u,layout:"vertical",initialValues:{recieved:Qe()(I(),"YYYY-MM-DD"),openS:d.open_recieved_mail?"JA":"NEIN"},hideRequiredMark:"true"},f={width:916,height:464},x={width:916,height:1296},g=a.useRef(null),ae=(0,a.useState)(null),T=(0,s.Z)(ae,2),U=T[0],V=T[1],L=(0,a.useState)(!1),ee=(0,s.Z)(L,2),ve=ee[0],H=ee[1],y=(0,a.useState)(!1),b=(0,s.Z)(y,2),J=b[0],X=b[1],pe=(0,a.useState)(!1),A=(0,s.Z)(pe,2),C=A[0],w=A[1],oe=a.useCallback(function(){var p,h=g==null||(p=g.current)===null||p===void 0?void 0:p.getScreenshot();de(h),V(h)},[g,V]),de=function(){var p=(0,_.Z)(D().mark(function h(K){var te;return D().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(K!=null){G.next=2;break}return G.abrupt("return");case 2:return X(!0),te={file:K,width:C?f.width:x.width,height:C?f.height:x.height,tesseract:!1},G.next=6,(0,N.ZP)($.Q+"/api/admin/ocrscanner",{method:"POST",data:te}).then(function(W){var De=W.pdf;De==null?H(!0):(H(!1),V("taken"),o(De))}).catch(function(W){H(!0),(0,ne.S)(W,!0,"Fehler","Das Bild konnte nicht konvertiert werden.")});case 6:X(!1);case 7:case"end":return G.stop()}},h)}));return function(K){return p.apply(this,arguments)}}(),Pe=function(){w(!C)},fe=function(){o(null),V(null)};return console.log(d),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(re.Z,(0,me.Z)((0,me.Z)({},Q),{},{onFinish:v,children:(0,e.jsxs)(le.Z,{style:{width:"1000px"},direction:"vertical",children:[(0,e.jsx)(m.Z,{title:"Notizen",children:d.notes}),R==="manual"?(0,e.jsx)(m.Z,{title:"Briefumschlag",children:U==="taken"?(0,e.jsx)(e.Fragment,{children:l===null?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(P.Z,{onClick:fe,children:"Bild entfernen"}),(0,e.jsx)(Oe.Z,{file:l,loading:!1,type:"base64"})]})}):(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(k.Z,{size:"large",defaultActiveKey:"1",style:{marginBottom:32},centered:!0,children:[(0,e.jsx)(k.Z.TabPane,{tab:"Photo",children:(0,e.jsxs)(le.Z,{style:{width:"100%"},direction:"vertical",children:[(0,e.jsxs)(z.ZP.Group,{size:"large",onChange:Pe,buttonStyle:"solid",defaultValue:"a",children:[(0,e.jsx)(z.ZP.Button,{style:{width:"458px",height:"50px"},value:"a",children:"Document"}),(0,e.jsx)(z.ZP.Button,{style:{width:"458px",height:"50px"},value:"b",children:"Brief"})]}),(0,e.jsx)(P.Z,{style:{width:"916px",height:"100px",borderRadius:"25px"},type:"primary",loading:J,onClick:oe,children:"PHOTO"}),U?(0,e.jsx)("img",{src:U}):(0,e.jsx)(Y(),{audio:!1,height:C?f.height:x.height,ref:g,screenshotFormat:"image/jpeg",screenshotQuality:.5,width:C?f.width:x.width,videoConstraints:C?f:x})]})},"1"),(0,e.jsx)(k.Z.TabPane,{tab:"Upload",children:(0,e.jsx)(Be.Z,{setOpenMail64:o,openMail64:l})},"2")]})})}):null,d.open_recieved_mail&&(0,e.jsxs)(m.Z,{title:"Ge\xF6ffneter Brief",children:[(0,e.jsx)(Be.Z,{setOpenMail64:M,openMail64:Z}),(0,e.jsx)(re.Z.Item,{name:"subject",label:Je.subject,children:(0,e.jsx)(Ue.Z,{size:"large"})})]}),(0,e.jsxs)(m.Z,{title:"Absender",children:[(0,e.jsx)(re.Z.Item,{name:"sender",rules:[{required:!0,message:"Absender fehlt"}],children:(0,e.jsx)(Ue.Z,{size:"large"})}),(0,e.jsx)(He,{children:(0,e.jsx)("blockquote",{children:(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:j}})})})]}),(0,e.jsx)(m.Z,{title:"Empfangen am",children:(0,e.jsx)(re.Z.Item,{name:"recieved",children:(0,e.jsx)(Ge.Z,{format:"YYYY-MM-DD"})})})]})})),(0,e.jsxs)("div",{style:{marginTop:"50px"},children:[(0,e.jsx)(P.Z,{onClick:function(){return S()},children:"Zur\xFCck"}),(0,e.jsx)(P.Z,{type:"primary",onClick:function(){return u==null?void 0:u.submit()},children:"Best\xE4tigen"})]})]})},we=function(n){var d=n.selComp,j=n.fileFrontMail,c=n.openMail64,S=n.sender,M=n.date,Z=n.prev,E=n.subject,B=n.setRegisteredMail_idd,F=n.next,l=(0,a.useState)(!1),o=(0,s.Z)(l,2),R=o[0],O=o[1],r=function(){var u=(0,_.Z)(D().mark(function I(){var v;return D().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return O(!0),v={id_company:d.id_company,coverView:j===null||j.length<10?"no_data":j,openedView:c===null||c.length<10?"no_data":c,sender:S==null?" ":S,date:M,subject:E==null?" ":E},f.next=4,(0,N.ZP)($.Q+"/api/admin/uploadmail",{method:"POST",data:v}).then(function(x){x>10&&(B(x),F(),be.default.success("Erfolgreich hochgeladen"))}).catch(function(x){(0,ne.S)(x,!0,"Fehler","Die Sendung konnte nicht hochgeladen werden.")});case 4:O(!1);case 5:case"end":return f.stop()}},I)}));return function(){return u.apply(this,arguments)}}();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(m.Z,{title:"Firma",children:(0,e.jsx)("h1",{children:d==null?void 0:d.name})}),(0,e.jsxs)(le.Z,{direction:"horizontal",children:[(0,e.jsx)(m.Z,{title:"Unge\xF6ffnete Ansicht",children:(0,e.jsx)(Oe.Z,{file:j,loading:!1,type:"base64"})}),c===null?null:(0,e.jsx)(m.Z,{title:"Ge\xF6ffnete Ansicht",children:(0,e.jsx)(Oe.Z,{file:c,loading:!1,type:"base64"})})]}),c===null?null:(0,e.jsx)(m.Z,{title:"Betreff",children:(0,e.jsx)("h1",{children:E})}),(0,e.jsx)(m.Z,{title:"Absender",children:(0,e.jsx)("h1",{children:S})}),(0,e.jsx)(m.Z,{title:"Datum",children:(0,e.jsx)("h1",{children:M})}),(0,e.jsx)(P.Z,{onClick:Z,children:"Zur\xFCck"}),(0,e.jsx)(P.Z,{type:"primary",onClick:r,loading:R,children:"Hochladen"})]})},ke=function(n){var d=n.dispatch,j=n.onload,c=(0,se.md)(),S=(0,a.useState)("auto"),M=(0,s.Z)(S,2),Z=M[0],E=M[1],B=(0,a.useState)(0),F=(0,s.Z)(B,2),l=F[0],o=F[1],R=(0,a.useState)(""),O=(0,s.Z)(R,2),r=O[0],u=O[1],I=(0,a.useState)(""),v=(0,s.Z)(I,2),Q=v[0],f=v[1],x=(0,a.useState)(null),g=(0,s.Z)(x,2),ae=g[0],T=g[1],U=(0,a.useState)(null),V=(0,s.Z)(U,2),L=V[0],ee=V[1],ve=(0,a.useState)("unbekannt"),H=(0,s.Z)(ve,2),y=H[0],b=H[1],J=(0,a.useState)(""),X=(0,s.Z)(J,2),pe=X[0],A=X[1],C=(0,a.useState)(""),w=(0,s.Z)(C,2),oe=w[0],de=w[1],Pe=a.useState(0),fe=(0,s.Z)(Pe,2),p=fe[0],h=fe[1],K=function(){h(p+1)},te=function(){h(p-1)},xe=function(){u(""),f(""),T(null),ee(null),b("unbekannt"),A(""),o(0),h(0)},G=[{title:"Firma aussuchen",content:(0,e.jsx)(Ve,{compSel:u,next:K,loadFileFrontMail:T,selectedText:f,setManualOrAuto:E,company:r})},{title:"Daten erg\xE4nzen",content:(0,e.jsx)(Xe,{selComp:r,selText:Q,next:K,prev:te,setOpenMail64:ee,openMail64:L,setSenderr:b,setDatee:A,setSubjectt:de,frontMail:ae,loadFileFrontMail:T,manualOrAuto:Z})},{title:"Upload \xDCberpr\xFCfen",content:(0,e.jsx)(we,{selComp:r,fileFrontMail:ae,openMail64:L,sender:y,date:pe,prev:te,subject:oe,setRegisteredMail_idd:o,next:K})},{title:"Mail ID",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(m.Z,{title:"Mail ID",children:(0,e.jsx)("h1",{children:l})}),(0,e.jsx)(P.Z,{onClick:xe,type:"primary",children:"OK"})]})}];return(0,e.jsx)(se.Nv,{accessible:c.canAdmin,fallback:function(){return se.m8.push("/exception/403")},children:(0,e.jsxs)("div",{style:{margin:"auto",width:"70%"},children:[(0,e.jsx)(m.Z,{children:(0,e.jsx)(ce.Z,{current:p,children:G.map(function(W){return(0,e.jsx)(ce.Z.Step,{title:W.title},W.title)})})}),(0,e.jsx)("div",{className:he().content,children:G[p].content})]})})}}}]);
